%
\begin{isabellebody}%
\setisabellecontext{Edmonds{\isacharunderscore}{\kern0pt}Karp{\isacharunderscore}{\kern0pt}Impl}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Edmonds{\isacharunderscore}{\kern0pt}Karp{\isacharunderscore}{\kern0pt}Impl\isanewline
\ \ \isakeyword{imports}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharslash}{\kern0pt}Alternating{\isacharunderscore}{\kern0pt}BFS{\isacharslash}{\kern0pt}Alternating{\isacharunderscore}{\kern0pt}BFS{\isacharunderscore}{\kern0pt}Impl{\isachardoublequoteclose}\isanewline
\ \ \ \ Edmonds{\isacharunderscore}{\kern0pt}Karp{\isacharunderscore}{\kern0pt}Partial\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
We now show that our specification of the Edmonds-Karp algorithm in locale \isa{edmonds{\isacharunderscore}{\kern0pt}karp}
can be implemented via red-black trees.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{global{\isacharunderscore}{\kern0pt}interpretation}\isamarkupfalse%
\ E{\isacharcolon}{\kern0pt}\ edmonds{\isacharunderscore}{\kern0pt}karp\ \isakeyword{where}\isanewline
\ \ Map{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ empty\ \isakeyword{and}\isanewline
\ \ Map{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update\ \isakeyword{and}\isanewline
\ \ Map{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete\ \isakeyword{and}\isanewline
\ \ Map{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup\ \isakeyword{and}\isanewline
\ \ Map{\isacharunderscore}{\kern0pt}inorder\ {\isacharequal}{\kern0pt}\ inorder\ \isakeyword{and}\isanewline
\ \ Map{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ rbt\ \isakeyword{and}\isanewline
\ \ Set{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ empty\ \isakeyword{and}\isanewline
\ \ Set{\isacharunderscore}{\kern0pt}insert\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ \isakeyword{and}\isanewline
\ \ Set{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ delete\ \isakeyword{and}\isanewline
\ \ Set{\isacharunderscore}{\kern0pt}isin\ {\isacharequal}{\kern0pt}\ isin\ \isakeyword{and}\isanewline
\ \ Set{\isacharunderscore}{\kern0pt}inorder\ {\isacharequal}{\kern0pt}\ inorder\ \isakeyword{and}\isanewline
\ \ Set{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ rbt\ \isakeyword{and}\isanewline
\ \ P{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ empty\ \isakeyword{and}\isanewline
\ \ P{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update\ \isakeyword{and}\isanewline
\ \ P{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete\ \isakeyword{and}\isanewline
\ \ P{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup\ \isakeyword{and}\isanewline
\ \ P{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ M{\isachardot}{\kern0pt}invar\ \isakeyword{and}\isanewline
\ \ Q{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ Queue{\isachardot}{\kern0pt}empty\ \isakeyword{and}\isanewline
\ \ Q{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}empty\ \isakeyword{and}\isanewline
\ \ Q{\isacharunderscore}{\kern0pt}snoc\ {\isacharequal}{\kern0pt}\ snoc\ \isakeyword{and}\isanewline
\ \ Q{\isacharunderscore}{\kern0pt}head\ {\isacharequal}{\kern0pt}\ head\ \isakeyword{and}\isanewline
\ \ Q{\isacharunderscore}{\kern0pt}tail\ {\isacharequal}{\kern0pt}\ tail\ \isakeyword{and}\isanewline
\ \ Q{\isacharunderscore}{\kern0pt}invar\ {\isacharequal}{\kern0pt}\ Queue{\isachardot}{\kern0pt}invar\ \isakeyword{and}\isanewline
\ \ Q{\isacharunderscore}{\kern0pt}list\ {\isacharequal}{\kern0pt}\ list\ \isakeyword{and}\isanewline
\ \ M{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ empty\ \isakeyword{and}\isanewline
\ \ M{\isacharunderscore}{\kern0pt}update\ {\isacharequal}{\kern0pt}\ update\ \isakeyword{and}\isanewline
\ \ M{\isacharunderscore}{\kern0pt}delete\ {\isacharequal}{\kern0pt}\ RBT{\isacharunderscore}{\kern0pt}Map{\isachardot}{\kern0pt}delete\ \isakeyword{and}\isanewline
\ \ M{\isacharunderscore}{\kern0pt}lookup\ {\isacharequal}{\kern0pt}\ lookup\ \isakeyword{and}\isanewline
\ \ M{\isacharunderscore}{\kern0pt}inorder\ {\isacharequal}{\kern0pt}\ inorder\ \isakeyword{and}\isanewline
\ \ M{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ rbt\isanewline
\ \ \isakeyword{defines}\ is{\isacharunderscore}{\kern0pt}free{\isacharunderscore}{\kern0pt}vertex\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}free{\isacharunderscore}{\kern0pt}vertex\isanewline
\ \ \isakeyword{and}\ free{\isacharunderscore}{\kern0pt}vertices\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}free{\isacharunderscore}{\kern0pt}vertices\isanewline
\ \ \isakeyword{and}\ G{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}G{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}\isanewline
\ \ \isakeyword{and}\ G{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}G{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \isakeyword{and}\ G{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{3}}\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}G{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{3}}\isanewline
\ \ \isakeyword{and}\ G{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}G{\isadigit{2}}\isanewline
\ \ \isakeyword{and}\ G{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}G{\isadigit{1}}\isanewline
\ \ \isakeyword{and}\ done{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}done{\isacharunderscore}{\kern0pt}{\isadigit{1}}\isanewline
\ \ \isakeyword{and}\ done{\isacharunderscore}{\kern0pt}{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}done{\isacharunderscore}{\kern0pt}{\isadigit{2}}\isanewline
\ \ \isakeyword{and}\ augment\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}augment\isanewline
\ \ \isakeyword{and}\ loop{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}partial\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}loop{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}partial\isanewline
\ \ \isakeyword{and}\ edmonds{\isacharunderscore}{\kern0pt}karp{\isacharunderscore}{\kern0pt}partial\ {\isacharequal}{\kern0pt}\ E{\isachardot}{\kern0pt}edmonds{\isacharunderscore}{\kern0pt}karp{\isacharunderscore}{\kern0pt}partial\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{declare}\isamarkupfalse%
\ rev{\isacharunderscore}{\kern0pt}follow{\isacharunderscore}{\kern0pt}partial{\isachardot}{\kern0pt}simps\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}\isanewline
\isacommand{declare}\isamarkupfalse%
\ E{\isachardot}{\kern0pt}loop{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}partial{\isachardot}{\kern0pt}simps\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}\isanewline
%
\isadeliminvisible
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{thm}\isamarkupfalse%
\ E{\isachardot}{\kern0pt}loop{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}partial{\isachardot}{\kern0pt}simps\isanewline
\isacommand{value}\isamarkupfalse%
\ {\isachardoublequoteopen}alt{\isacharunderscore}{\kern0pt}bfs{\isacharunderscore}{\kern0pt}partial\ {\isacharparenleft}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isacommand{value}\isamarkupfalse%
\ {\isachardoublequoteopen}loop{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}partial\ {\isacharparenleft}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\ {\isadigit{2}}\ empty{\isachardoublequoteclose}\isanewline
\isacommand{value}\isamarkupfalse%
\ {\isachardoublequoteopen}edmonds{\isacharunderscore}{\kern0pt}karp{\isacharunderscore}{\kern0pt}partial\ {\isacharparenleft}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}update\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}RBT{\isacharunderscore}{\kern0pt}Set{\isachardot}{\kern0pt}insert\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}\ empty{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/1_projects/2022_idp/thys/Hopcroft_Karp/Edmonds_Karp_Impl.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%24=8%:%
%:%25=9%:%
%:%27=12%:%
%:%28=12%:%
%:%29=13%:%
%:%30=14%:%
%:%31=15%:%
%:%32=16%:%
%:%33=17%:%
%:%34=18%:%
%:%35=19%:%
%:%36=20%:%
%:%37=21%:%
%:%38=22%:%
%:%39=23%:%
%:%40=24%:%
%:%41=25%:%
%:%42=26%:%
%:%43=27%:%
%:%44=28%:%
%:%45=29%:%
%:%46=30%:%
%:%47=31%:%
%:%48=32%:%
%:%49=33%:%
%:%50=34%:%
%:%51=35%:%
%:%52=36%:%
%:%53=37%:%
%:%54=38%:%
%:%55=39%:%
%:%56=40%:%
%:%57=41%:%
%:%58=42%:%
%:%59=43%:%
%:%60=44%:%
%:%61=45%:%
%:%62=46%:%
%:%63=47%:%
%:%64=48%:%
%:%65=49%:%
%:%66=50%:%
%:%67=51%:%
%:%68=52%:%
%:%69=53%:%
%:%70=54%:%
%:%73=55%:%
%:%77=55%:%
%:%83=55%:%
%:%86=56%:%
%:%87=57%:%
%:%88=57%:%
%:%89=58%:%
%:%90=58%:%
%:%97=59%:%
%:%98=59%:%
%:%99=60%:%
%:%100=60%:%
%:%101=61%:%
%:%102=61%:%
%:%103=62%:%
%:%104=62%:%
%:%109=62%:%
%:%114=63%:%
%:%119=64%:%