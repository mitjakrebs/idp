%
\begin{isabellebody}%
\setisabellecontext{Queue}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Queue\isanewline
\ \ \isakeyword{imports}\ Queue{\isacharunderscore}{\kern0pt}Specs\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
On the low level, this interface is implemented using a pair of \isa{list}s. Our implementation is
based on Okasaki, C. (1999). Purely functional data structures. Cambridge University Press.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ queue\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ list\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ empty\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ queue{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}empty\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}empty\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ queue\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ f\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ queue\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ queue\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ queue{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}queue\ {\isacharparenleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ r{\isacharcomma}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}queue\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ snoc\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ queue\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ queue{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}snoc\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ queue\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ x\ {\isacharhash}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ head\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ queue\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}head\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ f{\isacharcomma}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ tail\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ queue\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ queue{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}tail\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ queue\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ invar\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ queue\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}invar\ {\isacharparenleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isasymlongleftrightarrow}\ r\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}invar\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ True{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ list\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ queue\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ list{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}list\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isacharat}{\kern0pt}\ {\isacharparenleft}{\kern0pt}rev\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list\ empty\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ empty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}invar\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}empty\ q\ {\isasymlongleftrightarrow}\ list\ q\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ r\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}snoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}invar\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list\ {\isacharparenleft}{\kern0pt}snoc\ q\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ list\ q\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ r\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ f{\isacharparenright}{\kern0pt}\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}emptyE{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}invar\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}list\ q\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{obtains}\ x\ f\ r\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ r\ \isakeyword{where}\isanewline
\ \ \ \ q{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ is{\isacharunderscore}{\kern0pt}empty\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}f\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{obtain}\isamarkupfalse%
\ x\ f{\isacharprime}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}f\ {\isacharequal}{\kern0pt}\ x\ {\isacharhash}{\kern0pt}\ f{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\ simp{\isacharplus}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ that{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}head{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}invar\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}list\ q\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}head\ q\ {\isacharequal}{\kern0pt}\ hd\ {\isacharparenleft}{\kern0pt}list\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ elim{\isacharcolon}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}emptyE{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}tail{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}invar\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}list\ q\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}list\ {\isacharparenleft}{\kern0pt}tail\ q{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ tl\ {\isacharparenleft}{\kern0pt}list\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ x\ r\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}elim\ list{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}emptyE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ f{\isacharparenright}{\kern0pt}\ simp{\isacharplus}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}invar\ empty{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ empty{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}snoc{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}invar\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}invar\ {\isacharparenleft}{\kern0pt}snoc\ q\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ r\ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ f{\isacharparenright}{\kern0pt}\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}r\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}invar\ {\isacharparenleft}{\kern0pt}f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ f{\isacharparenright}{\kern0pt}\ simp{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isataginvisible
\isacommand{lemma}\isamarkupfalse%
\ invar{\isacharunderscore}{\kern0pt}tail{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}invar\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}list\ q\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}invar\ {\isacharparenleft}{\kern0pt}tail\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\endisataginvisible
{\isafoldinvisible}%
%
\isadeliminvisible
\isanewline
%
\endisadeliminvisible
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ f\ x\ r\ \isakeyword{where}\isanewline
\ \ \ \ q{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}q\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isacharhash}{\kern0pt}\ f{\isacharcomma}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}elim\ list{\isacharunderscore}{\kern0pt}non{\isacharunderscore}{\kern0pt}emptyE{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ q\ intro{\isacharcolon}{\kern0pt}\ invar{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ y\ ys{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{interpretation}\isamarkupfalse%
\ Q{\isacharcolon}{\kern0pt}\ Queue\ \isakeyword{where}\isanewline
\ \ empty\ {\isacharequal}{\kern0pt}\ empty\ \isakeyword{and}\isanewline
\ \ is{\isacharunderscore}{\kern0pt}empty\ {\isacharequal}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}empty\ \isakeyword{and}\isanewline
\ \ snoc\ {\isacharequal}{\kern0pt}\ snoc\ \isakeyword{and}\isanewline
\ \ head\ {\isacharequal}{\kern0pt}\ head\ \isakeyword{and}\isanewline
\ \ tail\ {\isacharequal}{\kern0pt}\ tail\ \isakeyword{and}\isanewline
\ \ invar\ {\isacharequal}{\kern0pt}\ invar\ \isakeyword{and}\isanewline
\ \ list\ {\isacharequal}{\kern0pt}\ list\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}empty\ invar{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ is{\isacharunderscore}{\kern0pt}empty\ list{\isacharunderscore}{\kern0pt}snoc\ list{\isacharunderscore}{\kern0pt}head\ list{\isacharunderscore}{\kern0pt}tail\ invar{\isacharunderscore}{\kern0pt}snoc\ invar{\isacharunderscore}{\kern0pt}tail\ Queue{\isachardot}{\kern0pt}intro{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/Documents/1_projects/2022_idp/thys/Queue/Queue.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%22=6%:%
%:%23=7%:%
%:%25=10%:%
%:%26=10%:%
%:%27=11%:%
%:%28=12%:%
%:%29=12%:%
%:%30=13%:%
%:%31=14%:%
%:%32=15%:%
%:%33=15%:%
%:%34=16%:%
%:%35=17%:%
%:%36=18%:%
%:%37=18%:%
%:%38=19%:%
%:%39=20%:%
%:%40=21%:%
%:%41=22%:%
%:%42=22%:%
%:%43=23%:%
%:%44=24%:%
%:%45=25%:%
%:%46=25%:%
%:%47=26%:%
%:%48=27%:%
%:%49=28%:%
%:%50=28%:%
%:%51=29%:%
%:%52=30%:%
%:%53=31%:%
%:%54=31%:%
%:%55=32%:%
%:%56=33%:%
%:%57=34%:%
%:%58=35%:%
%:%59=35%:%
%:%60=36%:%
%:%63=37%:%
%:%68=38%:%
%:%69=38%:%
%:%70=39%:%
%:%75=39%:%
%:%80=40%:%
%:%84=40%:%
%:%85=40%:%
%:%90=40%:%
%:%95=41%:%
%:%100=42%:%
%:%101=42%:%
%:%102=43%:%
%:%103=44%:%
%:%108=44%:%
%:%117=45%:%
%:%118=45%:%
%:%119=46%:%
%:%120=46%:%
%:%121=47%:%
%:%122=48%:%
%:%123=48%:%
%:%124=49%:%
%:%125=49%:%
%:%126=50%:%
%:%127=50%:%
%:%128=51%:%
%:%129=51%:%
%:%130=52%:%
%:%136=52%:%
%:%141=53%:%
%:%146=54%:%
%:%147=54%:%
%:%148=55%:%
%:%149=56%:%
%:%154=56%:%
%:%163=57%:%
%:%164=57%:%
%:%165=58%:%
%:%166=58%:%
%:%167=59%:%
%:%168=60%:%
%:%169=60%:%
%:%170=61%:%
%:%171=61%:%
%:%172=62%:%
%:%173=62%:%
%:%174=63%:%
%:%175=63%:%
%:%176=64%:%
%:%182=64%:%
%:%187=65%:%
%:%192=66%:%
%:%193=66%:%
%:%194=67%:%
%:%195=68%:%
%:%196=69%:%
%:%197=70%:%
%:%202=70%:%
%:%211=71%:%
%:%212=71%:%
%:%213=72%:%
%:%214=72%:%
%:%215=73%:%
%:%216=74%:%
%:%217=74%:%
%:%218=75%:%
%:%219=75%:%
%:%220=76%:%
%:%221=76%:%
%:%222=77%:%
%:%223=77%:%
%:%224=78%:%
%:%225=78%:%
%:%226=79%:%
%:%227=79%:%
%:%228=80%:%
%:%229=80%:%
%:%230=80%:%
%:%231=81%:%
%:%232=82%:%
%:%233=82%:%
%:%234=83%:%
%:%235=83%:%
%:%236=84%:%
%:%237=84%:%
%:%238=85%:%
%:%244=85%:%
%:%249=86%:%
%:%254=87%:%
%:%255=87%:%
%:%256=88%:%
%:%257=89%:%
%:%258=90%:%
%:%263=90%:%
%:%268=91%:%
%:%272=91%:%
%:%273=91%:%
%:%274=92%:%
%:%275=92%:%
%:%280=92%:%
%:%285=93%:%
%:%290=94%:%
%:%291=94%:%
%:%292=95%:%
%:%293=96%:%
%:%294=97%:%
%:%299=97%:%
%:%308=98%:%
%:%309=98%:%
%:%310=99%:%
%:%311=99%:%
%:%312=100%:%
%:%313=101%:%
%:%314=101%:%
%:%315=102%:%
%:%316=102%:%
%:%317=103%:%
%:%318=103%:%
%:%319=104%:%
%:%320=104%:%
%:%321=105%:%
%:%327=105%:%
%:%332=106%:%
%:%337=107%:%
%:%338=107%:%
%:%339=108%:%
%:%344=108%:%
%:%349=109%:%
%:%353=109%:%
%:%354=109%:%
%:%359=109%:%
%:%364=110%:%
%:%369=111%:%
%:%370=111%:%
%:%371=112%:%
%:%372=113%:%
%:%377=113%:%
%:%386=114%:%
%:%387=114%:%
%:%388=115%:%
%:%389=115%:%
%:%390=116%:%
%:%391=117%:%
%:%392=117%:%
%:%393=118%:%
%:%394=118%:%
%:%395=119%:%
%:%396=119%:%
%:%397=120%:%
%:%398=120%:%
%:%399=121%:%
%:%405=121%:%
%:%410=122%:%
%:%415=123%:%
%:%416=123%:%
%:%417=124%:%
%:%418=125%:%
%:%423=125%:%
%:%428=126%:%
%:%432=126%:%
%:%433=126%:%
%:%434=127%:%
%:%435=127%:%
%:%440=127%:%
%:%445=128%:%
%:%450=129%:%
%:%451=129%:%
%:%452=130%:%
%:%453=131%:%
%:%454=132%:%
%:%459=132%:%
%:%468=133%:%
%:%469=133%:%
%:%470=134%:%
%:%471=134%:%
%:%472=135%:%
%:%473=136%:%
%:%474=136%:%
%:%475=137%:%
%:%476=137%:%
%:%477=138%:%
%:%478=138%:%
%:%479=139%:%
%:%480=139%:%
%:%481=140%:%
%:%482=140%:%
%:%483=141%:%
%:%484=141%:%
%:%485=142%:%
%:%486=142%:%
%:%487=143%:%
%:%488=143%:%
%:%489=144%:%
%:%490=144%:%
%:%491=145%:%
%:%492=145%:%
%:%493=146%:%
%:%494=146%:%
%:%495=147%:%
%:%496=147%:%
%:%497=148%:%
%:%498=148%:%
%:%499=149%:%
%:%505=149%:%
%:%508=150%:%
%:%509=151%:%
%:%510=151%:%
%:%511=152%:%
%:%512=153%:%
%:%513=154%:%
%:%514=155%:%
%:%515=156%:%
%:%516=157%:%
%:%517=158%:%
%:%520=159%:%
%:%524=159%:%
%:%525=159%:%
%:%526=160%:%
%:%527=160%:%
%:%532=160%:%
%:%537=161%:%
%:%542=162%:%